@model Bar.API.ViewModels.IndexViewModel
@{
    ViewData["Title"] = "Home Page";
}
<style>
    .myFace{
        font-size: 30px;
    }
    a{
        font-size: 10px;
    }
</style>

<div class="text-center myFace">
    <table class="table table-bordered">
        <thead>
            <tr>
                <td>#</td>
                <td>Vrijeme</td>
                <td>Stavke</td>
                <td>Iznos</td>
                <td>User</td>
            </tr>
        </thead>
        <tbody>
            @foreach (var order in Model.OrderList)
            {
                decimal cijenaStavke = 0;
                <tr>
                    <td>@order.Id</td>
                    <td>@order.DateTime.ToString("H:mm:ss")</td>
                    <td>
                        @foreach (var x in order.Items)
                        {
                            cijenaStavke += x.Item1.Price;
                            <span>@x.Item1.Naziv x@(x.Item2)</span>
                            @if (order.Items.IndexOf(x) != order.Items.Count - 1)
                            {
                                <span>,</span>
                            }
                        }
                    </td>
                    <td>@(cijenaStavke) KM</td>
                    <td>@order.ApplicationUser</td>
                </tr>
            }
        </tbody>
    </table>
</div>
@section Scripts{
    <script>
        $(function () {
            var connection = new signalR.HubConnectionBuilder().withUrl("/myHub").build();

            connection.start().then(function () {
                //getData();
            });

            connection.on("RefreshMessage", function () {
                //getData();
                location.reload();
            });
        });

                    //function getData() {
                    //    var container = $('#dataStorage');
                    //    $.ajax({
                    //        url: '/AdministrativniRadnik/PregledKategorijaGetData',
                    //        contentType: 'application/html ; charset:utf-8',
                    //        type: 'GET',
                    //        dataType: 'html'
                    //    })
                    //        .done(function (result) { container.empty().append(result); })
                    //}
    </script>
}
